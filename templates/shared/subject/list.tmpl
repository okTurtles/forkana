<div class="flex-list">
	{{if .HasSearchKeyword}}
		{{/* When searching, show exact match and similar results separately */}}
		{{if .Keyword}}
			<div class="tw-font-bold tw-text-base tw-mb-4">
				{{ctx.Locale.Tr "explore.search_results_for" .Keyword}}
			</div>
		{{end}}

		{{/* No Exact Match - Show Create Button */}}
		{{if not .ExactMatch}}
			<div class="tw-mb-6">
				<p class="tw-flex tw-items-center tw-gap-2 tw-italic tw-text-sm text muted tw-mb-3">
					{{svg "octicon-skip" 16}} {{ctx.Locale.Tr "search.no_exact_page_found" .Keyword}}
				</p>
				<a class="ui primary button" href="{{AppSubUrl}}/repo/create?subject={{QueryEscape .Keyword}}">
					{{ctx.Locale.Tr "search.create_new_subject"}}
				</a>
			</div>
		{{end}}

		{{/* Exact Match Section */}}
		{{if .ExactMatch}}
			{{with .ExactMatch}}
				<div class="flex-item">
					<div class="flex-item-leading">
						{{svg "octicon-book" 24}}
					</div>
					<div class="flex-item-main">
						<div class="flex-item-header">
							<div class="flex-item-title">
								<a class="text primary name" href="/subject/{{PathEscapeSegments .Name}}">{{.Name}}</a>
							</div>
							<div class="flex-item-trailing muted-links">
								{{if gt .RootRepoCount 0}}
									<span class="flex-text-inline" data-tooltip-content="{{ctx.Locale.Tr "explore.subject.root_repositories"}}">
										{{svg "octicon-repo" 16}}
										<span>{{.RootRepoCount}}</span>
									</span>
								{{end}}
								{{if gt .RepoCount .RootRepoCount}}
									<span class="flex-text-inline" data-tooltip-content="{{ctx.Locale.Tr "explore.subject.total_repositories"}}">
										{{svg "octicon-repo-forked" 16}}
										<span>{{.RepoCount}}</span>
									</span>
								{{end}}
							</div>
						</div>
						<div class="flex-item-body">
							<span class="text small muted">
								{{ctx.Locale.Tr "explore.subject.created"}} {{DateUtils.TimeSince .CreatedUnix}}
								{{if ne .CreatedUnix .UpdatedUnix}}
									· {{ctx.Locale.Tr "explore.subject.updated"}} {{DateUtils.TimeSince .UpdatedUnix}}
								{{end}}
							</span>
						</div>
					</div>
				</div>
			{{end}}
		{{end}}

		{{/* Similar Section */}}
		{{if .SimilarSubjects}}
			<div class="tw-font-semibold tw-text-base tw-mt-6 tw-mb-3 text muted">
				{{ctx.Locale.Tr "explore.subject.similar"}}
			</div>
			{{range .SimilarSubjects}}
				<div class="flex-item">
					<div class="flex-item-leading">
						{{svg "octicon-book" 24}}
					</div>
					<div class="flex-item-main">
						<div class="flex-item-header">
							<div class="flex-item-title">
								<a class="text primary name" href="/subject/{{PathEscapeSegments .Name}}">{{.Name}}</a>
							</div>
							<div class="flex-item-trailing muted-links">
								{{if gt .RootRepoCount 0}}
									<span class="flex-text-inline" data-tooltip-content="{{ctx.Locale.Tr "explore.subject.root_repositories"}}">
										{{svg "octicon-repo" 16}}
										<span>{{.RootRepoCount}}</span>
									</span>
								{{end}}
								{{if gt .RepoCount .RootRepoCount}}
									<span class="flex-text-inline" data-tooltip-content="{{ctx.Locale.Tr "explore.subject.total_repositories"}}">
										{{svg "octicon-repo-forked" 16}}
										<span>{{.RepoCount}}</span>
									</span>
								{{end}}
							</div>
						</div>
						<div class="flex-item-body">
							<span class="text small muted">
								{{ctx.Locale.Tr "explore.subject.created"}} {{DateUtils.TimeSince .CreatedUnix}}
								{{if ne .CreatedUnix .UpdatedUnix}}
									· {{ctx.Locale.Tr "explore.subject.updated"}} {{DateUtils.TimeSince .UpdatedUnix}}
								{{end}}
							</span>
						</div>
					</div>
				</div>
			{{end}}
		{{end}}

		{{/* No results message */}}
		{{if and (not .ExactMatch) (not .SimilarSubjects)}}
			<div>
				{{ctx.Locale.Tr "search.no_results"}}
			</div>
		{{end}}
	{{else}}
		{{/* When not searching, show all subjects normally */}}
		{{range .Subjects}}
			<div class="flex-item">
				<div class="flex-item-leading">
					{{svg "octicon-book" 24}}
				</div>
				<div class="flex-item-main">
					<div class="flex-item-header">
						<div class="flex-item-title">
							<a class="text primary name" href="/subject/{{PathEscapeSegments .Name}}">{{.Name}}</a>
						</div>
						<div class="flex-item-trailing muted-links">
							{{if gt .RootRepoCount 0}}
								<span class="flex-text-inline" data-tooltip-content="{{ctx.Locale.Tr "explore.subject.root_repositories"}}">
									{{svg "octicon-repo" 16}}
									<span>{{.RootRepoCount}}</span>
								</span>
							{{end}}
							{{if gt .RepoCount .RootRepoCount}}
								<span class="flex-text-inline" data-tooltip-content="{{ctx.Locale.Tr "explore.subject.total_repositories"}}">
									{{svg "octicon-repo-forked" 16}}
									<span>{{.RepoCount}}</span>
								</span>
							{{end}}
						</div>
					</div>
					<div class="flex-item-body">
						<span class="text small muted">
							{{ctx.Locale.Tr "explore.subject.created"}} {{DateUtils.TimeSince .CreatedUnix}}
							{{if ne .CreatedUnix .UpdatedUnix}}
								· {{ctx.Locale.Tr "explore.subject.updated"}} {{DateUtils.TimeSince .UpdatedUnix}}
							{{end}}
						</span>
					</div>
				</div>
			</div>
		{{else}}
			<div>
				{{ctx.Locale.Tr "search.no_results"}}
			</div>
		{{end}}
	{{end}}
</div>

